
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fantasy Sports Team Management</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; color: #333; }
    header { text-align: center; padding: 12px 0; background: #4CAF50; color: #fff; margin-bottom: 20px; }
    section { margin-bottom: 24px; padding: 12px; background: #fff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,.08); }
    h2 { margin-top: 0; }
    input, select { padding: 10px; margin: 6px 0; width: 100%; box-sizing: border-box; border-radius: 4px; border: 1px solid #ccc; }
    button { padding: 10px 16px; margin-top: 8px; background: #4CAF50; color: #fff; border: 0; border-radius: 4px; cursor: pointer; }
    button.secondary { background: #2f7a32; }
    button:hover { background: #45a049; }
    .row { display:flex; gap:8px; flex-wrap:wrap; }
    .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 10px; }
    .results { margin-top: 12px; }
    .results pre { background: #eee; padding: 10px; border-radius: 6px; white-space: pre-wrap; word-wrap: break-word; }
  </style>
</head>
<body>
  <header>
    <h1>Fantasy Sports Team Management</h1>
    <p>Manage your teams, draft players, and track performance!</p>
  </header>

  <!-- Service Endpoints -->
  <section>
    <h2>Service Endpoints</h2>
    <div class="grid">
      <div>
        <label for="teamBase">Team Service Base URL</label>
        <input id="teamBase" placeholder="https://team-svc.azurewebsites.net"/>
      </div>
      <div>
        <label for="playerBase">Player Service Base URL</label>
        <input id="playerBase" placeholder="https://player-svc.azurewebsites.net"/>
      </div>
      <div>
        <label for="perfBase">Performance Service Base URL</label>
        <input id="perfBase" placeholder="https://perf-svc.azurewebsites.net"/>
      </div>
      <div>
        <label for="lbBase">Leaderboard Service Base URL (optional)</label>
        <input id="lbBase" placeholder="https://leaderboard-svc.azurewebsites.net"/>
      </div>
    </div>
    <div class="row">
      <button id="saveCfg">Save</button>
      <button class="secondary" id="resetCfg">Reset</button>
    </div>
  </section>

  <!-- Team Management -->
  <section id="team-management">
    <h2>Team Management</h2>
    <div class="row">
      <button id="btnTeamsList">List Teams (GET /api/teams)</button>
      <button class="secondary" id="btnTeamsGraph">Graph (GET /api/graph)</button>
    </div>
    <form id="create-team-form">
      <label for="team-name">Create a New Team</label>
      <input type="text" id="team-name" placeholder="Enter team name" required/>
      <button type="submit">Create Team (POST /api/teams)</button>
    </form>
    <div class="grid">
      <div><label for="team-id">Team ID</label><input id="team-id" placeholder="Team GUID/ID"/></div>
      <div><label for="team-name-update">Update Name</label><input id="team-name-update" placeholder="New name"/></div>
    </div>
    <div class="row">
      <button id="btnTeamGet">Get Team (GET /api/teams/{id})</button>
      <button class="secondary" id="btnTeamUpdate">Update Team (PUT /api/teams/{id})</button>
      <button class="secondary" id="btnTeamDelete">Delete Team (DELETE /api/teams/{id})</button>
    </div>
    <div class="results" id="team-results"></div>
  </section>

  <!-- Player Management -->
  <section id="player-management">
    <h2>Player Management</h2>
    <div class="row">
      <button id="btnPlayersList">List Players (GET /api/players)</button>
      <button class="secondary" id="btnPlayersGraph">Graph (GET /api/graph)</button>
    </div>
    <div class="grid">
      <div><label for="player-id">Get Player ID</label><input id="player-id" placeholder="Player GUID/ID"/></div>
      <div><label for="player-id-draft">Draft Player ID</label><input id="player-id-draft" placeholder="Player GUID/ID"/></div>
      <div><label for="team-id-draft">Draft Team ID</label><input id="team-id-draft" placeholder="Team GUID/ID"/></div>
    </div>
    <div class="row">
      <button id="btnPlayerGet">Get Player (GET /api/players/{id})</button>
      <button class="secondary" id="btnDraft">Draft (POST /api/players/draft)</button>
      <button class="secondary" id="btnRelease">Release (POST /api/players/release)</button>
    </div>
    <div class="results" id="player-results"></div>
  </section>

  <!-- Performance Tracking -->
  <section id="performance-tracking">
    <h2>Performance Tracking</h2>
    <div class="row">
      <button id="btnPerfList">Get All Stats (GET /api/performance)</button>
    </div>
    <div class="grid">
      <div><label for="perf-player-id">Player ID</label><input id="perf-player-id" placeholder="Player GUID/ID"/></div>
      <div><label for="comp-name">Competition Name</label><input id="comp-name" placeholder="e.g., Week 1"/></div>
    </div>
    <div class="row">
      <button id="btnPerfGet">Get Player Stats (GET /api/performance/{playerId})</button>
      <button class="secondary" id="btnPerfSimulate">Simulate (POST /api/performance/simulate)</button>
    </div>
    <div class="results" id="competition-results"></div>
  </section>

  <!-- Leaderboard (optional) -->
  <section id="leaderboard">
    <h2>Leaderboard</h2>
    <button id="view-leaderboard">Leaderboard (GET /api/leaderboard)</button>
    <div class="results" id="leaderboard-results"></div>
  </section>

  <script>
    // -------- Config helpers --------
    const cfgKey = 'fantasy-sports-index-v1';
    const byId = (id) => document.getElementById(id);
    function readCfg(){ try{ return JSON.parse(localStorage.getItem(cfgKey)) || {}; } catch { return {}; } }
    function writeCfg(cfg){ localStorage.setItem(cfgKey, JSON.stringify(cfg)); }
    function loadCfg(){
      const c = readCfg();
      byId('teamBase').value   = c.teamBase   || '';
      byId('playerBase').value = c.playerBase || '';
      byId('perfBase').value   = c.perfBase   || '';
      byId('lbBase').value     = c.lbBase     || '';
    }
    function saveCfg(){
      writeCfg({
        teamBase: byId('teamBase').value.trim(),
        playerBase: byId('playerBase').value.trim(),
        perfBase: byId('perfBase').value.trim(),
        lbBase: byId('lbBase').value.trim(),
      });
      alert('Config saved.');
    }
    function resetCfg(){ localStorage.removeItem(cfgKey); loadCfg(); alert('Config reset.'); }
    byId('saveCfg').onclick = saveCfg;
    byId('resetCfg').onclick = resetCfg;
    function bases(){ const c = readCfg(); return { team:c.teamBase, player:c.playerBase, perf:c.perfBase, lb:c.lbBase }; }

    // -------- Fetch wrapper --------
    async function call(method, base, path, body){
      const url = base + path;
      const headers = { 'Content-Type': 'application/json' };
      // If you use auth, inject here:
      // headers['Authorization'] = 'Bearer ' + token;
      const res = await fetch(url, { method, headers, body: body ? JSON.stringify(body) : undefined });
      const text = await res.text();
      let data = text; try { data = JSON.parse(text); } catch {}
      return { ok: res.ok, status: res.status, data };
    }
    function show(elId, data){ byId(elId).innerHTML = `<pre>${typeof data==='string' ? data : JSON.stringify(data, null, 2)}</pre>`; }

    // -------- Team --------
    document.getElementById("create-team-form").addEventListener("submit", async (e) => {
      e.preventDefault();
      const { team } = bases();
      const name = document.getElementById("team-name").value.trim();
      if (!team || !name) return alert('Set Team base URL and team name.');
      const r = await call("POST", team, "/api/teams", { name }); show("team-results", r.data);
    });
    document.getElementById("btnTeamsList").addEventListener("click", async () => {
      const { team } = bases(); if (!team) return alert('Set Team base URL.');
      const r = await call("GET", team, "/api/teams"); show("team-results", r.data);
    });
    document.getElementById("btnTeamsGraph").addEventListener("click", async () => {
      const { team } = bases(); if (!team) return alert('Set Team base URL.');
      const r = await call("GET", team, "/api/graph"); show("team-results", r.data);
    });
    document.getElementById("btnTeamGet").addEventListener("click", async () => {
      const { team } = bases(); const id = document.getElementById("team-id").value.trim();
      if (!team || !id) return alert('Set Team base URL and Team ID.');
      const r = await call("GET", team, `/api/teams/${id}`); show("team-results", r.data);
    });
    document.getElementById("btnTeamUpdate").addEventListener("click", async () => {
      const { team } = bases(); const id = document.getElementById("team-id").value.trim();
      const name = document.getElementById("team-name-update").value.trim();
      if (!team || !id || !name) return alert('Set Team base URL, ID, and new name.');
      const r = await call("PUT", team, `/api/teams/${id}`, { name }); show("team-results", r.data);
    });
    document.getElementById("btnTeamDelete").addEventListener("click", async () => {
      const { team } = bases(); const id = document.getElementById("team-id").value.trim();
      if (!team || !id) return alert('Set Team base URL and Team ID.');
      const r = await call("DELETE", team, `/api/teams/${id}`); show("team-results", r.data);
    });

    // -------- Players --------
    document.getElementById("btnPlayersList").addEventListener("click", async () => {
      const { player } = bases(); if (!player) return alert('Set Player base URL.');
      const r = await call("GET", player, "/api/players"); show("player-results", r.data);
    });
    document.getElementById("btnPlayersGraph").addEventListener("click", async () => {
      const { player } = bases(); if (!player) return alert('Set Player base URL.');
      const r = await call("GET", player, "/api/graph"); show("player-results", r.data);
    });
    document.getElementById("btnPlayerGet").addEventListener("click", async () => {
      const { player } = bases(); const id = document.getElementById("player-id").value.trim();
      if (!player || !id) return alert('Set Player base URL and Player ID.');
      const r = await call("GET", player, `/api/players/${id}`); show("player-results", r.data);
    });
    document.getElementById("btnDraft").addEventListener("click", async () => {
      const { player } = bases(); const pid = document.getElementById("player-id-draft").value.trim();
      const tid = document.getElementById("team-id-draft").value.trim();
      if (!player || !pid || !tid) return alert('Set Player base URL, Player ID, and Team ID.');
      const r = await call("POST", player, "/api/players/draft", { playerId: pid, teamId: tid }); show("player-results", r.data);
    });
    document.getElementById("btnRelease").addEventListener("click", async () => {
      const { player } = bases(); const pid = document.getElementById("player-id-draft").value.trim();
      if (!player || !pid) return alert('Set Player base URL and Player ID.');
      const r = await call("POST", player, "/api/players/release", { playerId: pid }); show("player-results", r.data);
    });

    // -------- Performance --------
    document.getElementById("btnPerfList").addEventListener("click", async () => {
      const { perf } = bases(); if (!perf) return alert('Set Performance base URL.');
      const r = await call("GET", perf, "/api/performance"); show("competition-results", r.data);
    });
    document.getElementById("btnPerfGet").addEventListener("click", async () => {
      const { perf } = bases(); const pid = document.getElementById("perf-player-id").value.trim();
      if (!perf || !pid) return alert('Set Performance base URL and Player ID.');
      const r = await call("GET", perf, `/api/performance/${pid}`); show("competition-results", r.data);
    });
    document.getElementById("btnPerfSimulate").addEventListener("click", async () => {
      const { perf } = bases(); const name = document.getElementById("comp-name").value.trim();
      if (!perf || !name) return alert('Set Performance base URL and competition name.');
      const r = await call("POST", perf, "/api/performance/simulate", { name }); show("competition-results", r.data);
    });

    // -------- Leaderboard (optional) --------
    document.getElementById("view-leaderboard").addEventListener("click", async () => {
      const { lb } = bases(); if (!lb) return alert('Set Leaderboard base URL.');
      const r = await call("GET", lb, "/api/leaderboard"); show("leaderboard-results", r.data);
    });

    // init
    loadCfg();
  </script>
</body>
</html>
